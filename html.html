<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="css/css.css">

        <title>Minirechner</title>
    </head>
    <body class="bg-[#121212]">
        <div style="display: block;" id="expansion">
            <svg viewBox="0,0 333,705" width="333" height="705" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top: 100px; left: 0; z-index: 10; border: 1px solid black">
                <rect width="50" height="50" x="190" y="185" fill="white" stroke="black" stroke-width="1" />
                <text x="194" y="210">CPLD</text>

                <circle cx="300" cy="42" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="INT" />
                <circle cx="300" cy="57" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="RD" />
                <circle cx="300" cy="72" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="FAN" />
                <circle cx="300" cy="87" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="W2" />
                <circle cx="300" cy="102" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="W1" />
                
                <circle cx="80" cy="677" r="5" stroke="black" stroke-width="0.5" fill="blue" class="AI1" />

                <circle cx="275" cy="677" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="AO1" />
                <circle cx="240" cy="677" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="AO2" />
                <circle cx="200" cy="677" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="CP1" />
                <circle cx="160" cy="677" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="CP2" />
                <circle cx="120" cy="677" r="5" stroke="black" stroke-width="0.5" fill="red" class="temp" />
                <circle cx="80" cy="677" r="5" stroke="black" stroke-width="0.5" fill="yellow" class="AI2" />
            </svg>
            <img src="assets/img/expansion.png" alt="" srcset="" style="position: absolute; top: 100px; left: 0; border: 1px solid black;">
            <script src="js/expansion.js"></script>
        </div>
        <div style="display: block;" id="a-con">
            <img class="" src="assets/img/2a.jpg" alt="" srcset="" style="position: absolute; width:650px; height: 920px; top: 0; left: 400px; border: 1px solid black; max-width: initial;">
            <textarea id="code-input" cols="50" rows="32" style="position: absolute; right: 100px; z-index: 20; display: none;">#! mrasm

LOOP:
    CLR R0
    LD R1, 1
    ADD R0, R1
    ADC R0, R1
    SUB R0, R1
    MUL R0, R1
    DIV R0, R1
    INC R0
    DEC R0
    NEG R0

    AND R0, R1
    OR  R0, R1
    XOR R0, R1
    COM R0
    BITS R0, R1
    BITC R0, R1

    TST R0
    CMP R0, R1
    BITT R0, R1

    LSR R0
    ASR R0
    LSL R0
    RRC R0
    RLC R0

    MOV R0, R1
    LD R0, 42
    LD R0, (0)
    ST (0xFF), R0
    LDSP 0x40
    PUSH R0
    POP R0
    PUSHF
    POPF
    LDFR 0xFF

    JCS CARRY_SET
CARRY_SET:
    JCC CARRY_CLEAR
CARRY_CLEAR:
    JZS ZERO_SET
ZERO_SET:
    JZC ZERO_CLEAR
ZERO_CLEAR:
    JNS NEGATIVE_SET
NEGATIVE_SET:
    JNC NEGATIVE_CLEAR
NEGATIVE_CLEAR:
    JR JUMP_HERE
JUMP_HERE:
    JMP NEXT
NEXT:
    CALL MY_SUBROUTINE
    EI
    DI
    NOP
    STOP
    RETI


MY_SUBROUTINE:
    RET
            </textarea>
            <script src="js/2a.js"></script>
        </div>
        <div style="display: none;" id="i-con">
            <img src="assets/img/2i.png" style="position: absolute; width:650px; height: 920px; top: 0; left: 0; border: 1px solid black; max-width: initial;">
            <textarea id="code-input" cols="50" rows="32" style="position: absolute; right: 100px;"># Multiplication: (FF) = (FC) * (FD)

00000: 00 00001 00 000 1100 01 01 1100 0 # R0 = FC
00001: 00 00010 01 000 0000 01 10 0001 0 # R0 = (R0)
00010: 00 00011 00 001 1101 01 01 1100 0 # R1 = FD
00011: 00 00100 01 001 0000 01 10 0001 0 # R1 = (R1)
00100: 00 00101 00 010 0000 01 00 0011 0 # R2 = 0
00101: 10 00111 00 000 0000 00 00 0001 0 # R0; JMP to 0011Z
00110: 00 01000 00 000 1111 01 01 0100 0 # R0 = R0 + FF; JMP 01000
00111: 00 01001 00 001 1110 01 01 1100 0 # R1 = FE; JMP 01001
01000: 00 00101 00 010 0001 01 00 0100 0 # R2 = R2 + R1; JMP 00101
01001: 00 00000 11 001 0010 00 00 1100 0 # (R1) = R2; JMP 00000
            </textarea>
            <div style="position: absolute; right: 200px; top: 500px;">
                <button type="button" onclick="clk()">Step</button>
                <button type="button" onclick="setInterval(clk, 500);">Start</button>
            </div>
            <!-- <script src="js/2i.js"></script> -->
        </div>
        <script>
            (async () => {
                var f2i = await fetch('/assets/svg/2i-diagramm.svg');
                var f2iText = await f2i.text();
                document.querySelector('#i-con').innerHTML += f2iText;
                document.querySelector('#i-con svg').style = "position: absolute; top: 64px; left: 64px; z-index: 10; border: 1px solid black;";
                
                var f2a = await fetch('/assets/svg/2a-diagramm.svg');
                var f2aText = await f2a.text();
                document.querySelector('#a-con').innerHTML += f2aText;
                document.querySelector('#a-con svg').style = "position: absolute; top: 64px; left: 464px; z-index: 10; border: 1px solid black; background-color: white;";
            })();

            for (const element of document.querySelectorAll("svg")) {
                element.addEventListener("click", (event) => {
                    console.log(event.offsetX + "," + event.offsetY);
                })
            }
        </script>
    </body>
</html>